# Лабораторная работа 2
Реализация протокола передачи файлов с условным названием FTP2.

## Структура пакета
* Заголовок
  * Байты 0..1 &ndash; размер имени файла N в байтах,
  * Байты 2..9 &ndash; размер файла M в байтах,
* N байт &ndash; имя файла,
* M байт &ndash; сам файл.

## Реализация клиента
Клиент отправляет файл, который расположен локально. Если
названия файла не был передан в качесте параметра командной
строки, он берётся из стандартного ввода. Путь файла обрезается
до имени файла, чтобы уменьшить длину пакета.

## Реализация сервера
Сервер обладает пулом из 20 потоков, чтобы иметь возможность
обрабатывать несколько клиентов сразу.

Каждый из потоков при приёме файла читает заголовок, чтобы
узнать длины файла и его имени. Имя файла повторно обрезается
до его чистого имени, чтобы недобросовестные клиенты не могли
записать файл за пределы директории `uploads/`, например, если 
задать имя как `../../../../../../var/lib/sessions/sess_12345`.

Затем поток читает файл, после чего проверяет его длину. Если
длина совпала с данной, то сервер возвращает успех, в противном
случае &ndash; неудачу. В случае неудачи скачанный файл удаляется.

Каждые 3 секунды поток логирует следующее: на сколько процентов
загружен файл, среднюю скорость загрузки в Мбит/с, мгновенную
скорость загрузки в Мбит/с. После скачивания в лог записывается
среднее время загрузки за всё время загрузки файла. Чтобы отличать
файлы, для каждой отдельной загрузки есть свой идентификатор
&ndash; job id. Он добавляется к каждой записи лога.

## Обработка ошибок
И сервер, и клиент в состоянии корректно обработать ошибки сети,
например, если один из них перестанет отвечать.